import LBL_Action from "@salesforce/label/c.LBL_Action";
import LBL_Button from "@salesforce/label/c.LBL_Button";
import LBL_Clone from "@salesforce/label/c.LBL_Clone";
import LBL_Control_Rules from "@salesforce/label/c.LBL_Control_Rules";
import LBL_Current_Fields from "@salesforce/label/c.LBL_Current_Fields";
import LBL_Default_Expression from "@salesforce/label/c.LBL_Default_Expression";
import LBL_Define_New_External_Control from "@salesforce/label/c.LBL_Define_New_External_Control";
import LBL_Deploy from "@salesforce/label/c.LBL_Deploy";
import LBL_Download_Zip from "@salesforce/label/c.LBL_Download_Zip";
import LBL_External_Control from "@salesforce/label/c.LBL_External_Control";
import LBL_Favorite_Color from "@salesforce/label/c.LBL_Favorite_Color";
import LBL_Field from "@salesforce/label/c.LBL_Field";
import LBL_Generate_Apex_Code from "@salesforce/label/c.LBL_Generate_Apex_Code";
import LBL_Generate_Page_Code from "@salesforce/label/c.LBL_Generate_Page_Code";
import LBL_Link from "@salesforce/label/c.LBL_Link";
import LBL_Live_Preview from "@salesforce/label/c.LBL_Live_Preview";
import LBL_Message from "@salesforce/label/c.LBL_Message";
import LBL_Message_Type from "@salesforce/label/c.LBL_Message_Type";
import LBL_Open_Page from "@salesforce/label/c.LBL_Open_Page";
import LBL_Overwrite from "@salesforce/label/c.LBL_Overwrite";
import LBL_Parent_Fields from "@salesforce/label/c.LBL_Parent_Fields";
import LBL_Personalised_Field from "@salesforce/label/c.LBL_Personalised_Field";
import LBL_Predefined_External_Controls from "@salesforce/label/c.LBL_Predefined_External_Controls";
import LBL_Preview_Page from "@salesforce/label/c.LBL_Preview_Page";
import LBL_Register from "@salesforce/label/c.LBL_Register";
import LBL_Replace_URL_With from "@salesforce/label/c.LBL_Replace_URL_With";
import LBL_Rerender from "@salesforce/label/c.LBL_Rerender";
import LBL_Select_Field from "@salesforce/label/c.LBL_Select_Field";
import LBL_Template_Label from "@salesforce/label/c.LBL_Template_Label";
import MSG_Check_Before_Deploy from "@salesforce/label/c.MSG_Check_Before_Deploy";
import MSG_Request_Timed_Out from "@salesforce/label/c.MSG_Request_Timed_Out";
import MSG_Rerender_Help_Text from "@salesforce/label/c.MSG_Rerender_Help_Text";
import MSG_Status_Unknown from "@salesforce/label/c.MSG_Status_Unknown";
import LBL_Add from "@salesforce/label/c.LBL_Add";
import LBL_Add_Separator from "@salesforce/label/c.LBL_Add_Separator";
import LBL_Advanced from "@salesforce/label/c.LBL_Advanced";
import LBL_All from "@salesforce/label/c.LBL_All";
import LBL_And from "@salesforce/label/c.LBL_And";
import LBL_Apply from "@salesforce/label/c.LBL_Apply";
import LBL_Available from "@salesforce/label/c.LBL_Available";
import LBL_Available_Fields from "@salesforce/label/c.LBL_Available_Fields";
import LBL_Background from "@salesforce/label/c.LBL_Background";
import LBL_Border from "@salesforce/label/c.LBL_Border";
import LBL_Cancel from "@salesforce/label/c.LBL_Cancel";
import LBL_Change_Type from "@salesforce/label/c.LBL_Change_Type";
import LBL_Color from "@salesforce/label/c.LBL_Color";
import LBL_Column from "@salesforce/label/c.LBL_Column";
import LBL_Column_Formating from "@salesforce/label/c.LBL_Column_Formating";
import LBL_Conditional_Formatting from "@salesforce/label/c.LBL_Conditional_Formatting";
import LBL_Confirm from "@salesforce/label/c.LBL_Confirm";
import LBL_Custom_Js from "@salesforce/label/c.LBL_Custom_Js";
import LBL_Dashed from "@salesforce/label/c.LBL_Dashed";
import LBL_Date from "@salesforce/label/c.LBL_Date";
import LBL_Default_Page_Size from "@salesforce/label/c.LBL_Default_Page_Size";
import LBL_Default_Value from "@salesforce/label/c.LBL_Default_Value";
import LBL_Delete from "@salesforce/label/c.LBL_Delete";
import LBL_Description from "@salesforce/label/c.LBL_Description";
import LBL_Detail_Object from "@salesforce/label/c.LBL_Detail_Object";
import LBL_Display_In_Totals from "@salesforce/label/c.LBL_Display_In_Totals";
import LBL_Dotted from "@salesforce/label/c.LBL_Dotted";
import LBL_Double from "@salesforce/label/c.LBL_Double";
import LBL_Edit from "@salesforce/label/c.LBL_Edit";
import LBL_End from "@salesforce/label/c.LBL_End";
import LBL_Export from "@salesforce/label/c.LBL_Export";
import LBL_Expression from "@salesforce/label/c.LBL_Expression";
import LBL_False from "@salesforce/label/c.LBL_False";
import LBL_Field_Name from "@salesforce/label/c.LBL_Field_Name";
import LBL_Field_Type from "@salesforce/label/c.LBL_Field_Type";
import LBL_Filter from "@salesforce/label/c.LBL_Filter";
import LBL_First from "@salesforce/label/c.LBL_First";
import LBL_Formating_Rule from "@salesforce/label/c.LBL_Formating_Rule";
import LBL_Grid_Layout from "@salesforce/label/c.LBL_Grid_Layout";
import LBL_Grid_Settings from "@salesforce/label/c.LBL_Grid_Settings";
import LBL_Groove from "@salesforce/label/c.LBL_Groove";
import LBL_Icon from "@salesforce/label/c.LBL_Icon";
import LBL_Icon_Settings from "@salesforce/label/c.LBL_Icon_Settings";
import LBL_Input from "@salesforce/label/c.LBL_Input";
import LBL_Inset from "@salesforce/label/c.LBL_Inset";
import LBL_Is_Field_Hidden from "@salesforce/label/c.LBL_Is_Field_Hidden";
import LBL_Last from "@salesforce/label/c.LBL_Last";
import LBL_Lower_Bound from "@salesforce/label/c.LBL_Lower_Bound";
import LBL_Master_Object from "@salesforce/label/c.LBL_Master_Object";
import LBL_Maximum from "@salesforce/label/c.LBL_Maximum";
import LBL_Minimum from "@salesforce/label/c.LBL_Minimum";
import LBL_New from "@salesforce/label/c.LBL_New";
import LBL_New_Template from "@salesforce/label/c.LBL_New_Template";
import LBL_New_Template_Name from "@salesforce/label/c.LBL_New_Template_Name";
import LBL_Next from "@salesforce/label/c.LBL_Next";
import LBL_No from "@salesforce/label/c.LBL_No";
import LBL_No_Item_To_Display from "@salesforce/label/c.LBL_No_Item_To_Display";
import LBL_None from "@salesforce/label/c.LBL_None";
import LBL_Number_Of_Fixed_Columns from "@salesforce/label/c.LBL_Number_Of_Fixed_Columns";
import LBL_Of from "@salesforce/label/c.LBL_Of";
import LBL_Operation from "@salesforce/label/c.LBL_Operation";
import LBL_Opposite_Style from "@salesforce/label/c.LBL_Opposite_Style";
import LBL_Option from "@salesforce/label/c.LBL_Option";
import LBL_Output from "@salesforce/label/c.LBL_Output";
import LBL_Outset from "@salesforce/label/c.LBL_Outset";
import LBL_Patern from "@salesforce/label/c.LBL_Patern";
import LBL_Picklist_Formatting from "@salesforce/label/c.LBL_Picklist_Formatting";
import LBL_Preview from "@salesforce/label/c.LBL_Preview";
import LBL_Previous from "@salesforce/label/c.LBL_Previous";
import LBL_Read_Only from "@salesforce/label/c.LBL_Read_Only";
import LBL_Ridge from "@salesforce/label/c.LBL_Ridge";
import LBL_Save from "@salesforce/label/c.LBL_Save";
import LBL_Save_As from "@salesforce/label/c.LBL_Save_As";
import LBL_Select_Columns from "@salesforce/label/c.LBL_Select_Columns";
import LBL_Select_Master_Object from "@salesforce/label/c.LBL_Select_Master_Object";
import LBL_Select_Object from "@salesforce/label/c.LBL_Select_Object";
import LBL_Select_Operation from "@salesforce/label/c.LBL_Select_Operation";
import LBL_Select_Total_Type from "@salesforce/label/c.LBL_Select_Total_Type";
import LBL_Selected from "@salesforce/label/c.LBL_Selected";
import LBL_Selected_Fields from "@salesforce/label/c.LBL_Selected_Fields";
import LBL_Settings from "@salesforce/label/c.LBL_Settings";
import LBL_Show_Hide_Columns from "@salesforce/label/c.LBL_Show_Hide_Columns";
import LBL_Size from "@salesforce/label/c.LBL_Size";
import LBL_Solid from "@salesforce/label/c.LBL_Solid";
import LBL_Start from "@salesforce/label/c.LBL_Start";
import LBL_Style from "@salesforce/label/c.LBL_Style";
import LBL_Template_List from "@salesforce/label/c.LBL_Template_List";
import LBL_Template_Name from "@salesforce/label/c.LBL_Template_Name";
import LBL_Template_Type from "@salesforce/label/c.LBL_Template_Type";
import LBL_Text from "@salesforce/label/c.LBL_Text";
import LBL_Total_Type from "@salesforce/label/c.LBL_Total_Type";
import LBL_True from "@salesforce/label/c.LBL_True";
import LBL_Type from "@salesforce/label/c.LBL_Type";
import LBL_Upload_File from "@salesforce/label/c.LBL_Upload_File";
import LBL_Upper_Bound from "@salesforce/label/c.LBL_Upper_Bound";
import LBL_User_Filters from "@salesforce/label/c.LBL_User_Filters";
import LBL_Value from "@salesforce/label/c.LBL_Value";
import LBL_Width from "@salesforce/label/c.LBL_Width";
import LBL_Yes from "@salesforce/label/c.LBL_Yes";
import MSG_Add_Related_Fields from "@salesforce/label/c.MSG_Add_Related_Fields";
import MSG_Application_Error from "@salesforce/label/c.MSG_Application_Error";
import MSG_Between_Value_Error from "@salesforce/label/c.MSG_Between_Value_Error";
import MSG_Confirm_Delete from "@salesforce/label/c.MSG_Confirm_Delete";
import MSG_Delete_Complete from "@salesforce/label/c.MSG_Delete_Complete";
import MSG_Deploy_Ended_With_Status from "@salesforce/label/c.MSG_Deploy_Ended_With_Status";
import MSG_Deploy_Last_Status from "@salesforce/label/c.MSG_Deploy_Last_Status";
import MSG_Error from "@salesforce/label/c.MSG_Error";
import MSG_Field_Already_Exist from "@salesforce/label/c.MSG_Field_Already_Exist";
import MSG_Field_Count_Exceded from "@salesforce/label/c.MSG_Field_Count_Exceded";
import MSG_Field_Length_Limit from "@salesforce/label/c.MSG_Field_Length_Limit";
import MSG_Fill_Required_Fields from "@salesforce/label/c.MSG_Fill_Required_Fields";
import MSG_Filter_On_Id_Help_Text from "@salesforce/label/c.MSG_Filter_On_Id_Help_Text";
import MSG_Format_Rule_Added from "@salesforce/label/c.MSG_Format_Rule_Added";
import MSG_Format_Rule_Removed from "@salesforce/label/c.MSG_Format_Rule_Removed";
import MSG_Information from "@salesforce/label/c.MSG_Information";
import MSG_Invalid_Expression from "@salesforce/label/c.MSG_Invalid_Expression";
import MSG_MISSING_FIELD from "@salesforce/label/c.MSG_MISSING_FIELD";
import MSG_No_Items_Selected from "@salesforce/label/c.MSG_No_Items_Selected";
import MSG_Save_As_Complete from "@salesforce/label/c.MSG_Save_As_Complete";
import MSG_Save_Complete from "@salesforce/label/c.MSG_Save_Complete";
import MSG_Success from "@salesforce/label/c.MSG_Success";
import MSG_Template_Name_Used_Overwrite from "@salesforce/label/c.MSG_Template_Name_Used_Overwrite";
import MSG_Template_No_Detail_Object from "@salesforce/label/c.MSG_Template_No_Detail_Object";
import MSG_Template_No_Master_Detail_Object from "@salesforce/label/c.MSG_Template_No_Master_Detail_Object";
import MSG_Template_No_Name from "@salesforce/label/c.MSG_Template_No_Name";
import MSG_Template_Type_Missing from "@salesforce/label/c.MSG_Template_Type_Missing";
import MSG_Warning from "@salesforce/label/c.MSG_Warning";

import { ShowToastEvent } from "lightning/platformShowToastEvent";
const Labels = {
    // // fake labels
    // LBL_Action: 'LBL_Action',
    // LBL_Button: 'LBL_Button',
    // LBL_Clone: 'LBL_Clone',
    // LBL_Control_Rules: 'LBL_Control_Rules',
    // LBL_Current_Fields: 'LBL_Current_Fields',
    // LBL_Default_Expression: 'LBL_Default_Expression',
    // LBL_Define_New_External_Control: 'LBL_Define_New_External_Control',
    // LBL_Deploy: 'LBL_Deploy',
    // LBL_Download_Zip: 'LBL_Download_Zip',
    // LBL_External_Control: 'LBL_External_Control',
    // LBL_Favorite_Color: 'LBL_Favorite_Color',
    // LBL_Field: 'LBL_Field',
    // LBL_Generate_Apex_Code: 'LBL_Generate_Apex_Code',
    // LBL_Generate_Page_Code: 'LBL_Generate_Page_Code',
    // LBL_Link: 'LBL_Link',
    // LBL_Live_Preview: 'LBL_Live_Preview',
    // LBL_Message_Type: 'LBL_Message_Type',
    // LBL_Message: 'LBL_Message',
    // LBL_Open_Page: 'LBL_Open_Page',
    // LBL_Overwrite: 'LBL_Overwrite',
    // LBL_Parent_Fields: 'LBL_Parent_Fields',
    // LBL_Personalised_Field: 'LBL_Personalised_Field',
    // LBL_Predefined_External_Controls: 'LBL_Predefined_External_Controls',
    // LBL_Preview_Page: 'LBL_Preview_Page',
    // LBL_Register: 'LBL_Register',
    // LBL_Replace_URL_With: 'LBL_Replace_URL_With',
    // LBL_Rerender: 'LBL_Rerender',
    // LBL_Select_Field: 'LBL_Select_Field',
    // LBL_Template_Label: 'LBL_Template_Label',
    // MSG_Check_Before_Deploy: 'MSG_Check_Before_Deploy',
    // MSG_Request_Timed_Out: 'MSG_Request_Timed_Out',
    // MSG_Rerender_Help_Text: 'MSG_Rerender_Help_Text',
    // MSG_Status_Unknown: 'MSG_Status_Unknown',
    // ///
    LBL_Internally_Calculated: 'Internally Calculated',
    LBL_URL_Settings: 'URL Settings',
    LBL_Display_Full_URL: 'Display full URL',
    LBL_RepLace_With_Text: 'Replace with Text',
    LBL_RepLace_With_Icon: 'Replace with Icon',
    LBL_Show_File_Input: 'Show File Input',
    LBL_Action,
    LBL_Button,
    LBL_Clone,
    LBL_Control_Rules,
    LBL_Current_Fields,
    LBL_Default_Expression,
    LBL_Define_New_External_Control,
    LBL_Deploy,
    LBL_Download_Zip,
    LBL_External_Control,
    LBL_Favorite_Color,
    LBL_Field,
    LBL_Generate_Apex_Code,
    LBL_Generate_Page_Code,
    LBL_Link,
    LBL_Live_Preview,
    LBL_Message_Type,
    LBL_Message,
    LBL_Open_Page,
    LBL_Overwrite,
    LBL_Parent_Fields,
    LBL_Personalised_Field,
    LBL_Predefined_External_Controls,
    LBL_Preview_Page,
    LBL_Register,
    LBL_Replace_URL_With,
    LBL_Rerender,
    LBL_Select_Field,
    LBL_Template_Label,
    MSG_Check_Before_Deploy,
    MSG_Request_Timed_Out,
    MSG_Rerender_Help_Text,
    MSG_Status_Unknown,
    //// real labels
    LBL_Add_Separator,
    LBL_Add,
    LBL_Advanced,
    LBL_All,
    LBL_And,
    LBL_Apply,
    LBL_Available_Fields,
    LBL_Available,
    LBL_Background,
    LBL_Border,
    LBL_Cancel,
    LBL_Change_Type,
    LBL_Color,
    LBL_Column_Formating,
    LBL_Column,
    LBL_Conditional_Formatting,
    LBL_Confirm,
    LBL_Custom_Js,
    LBL_Dashed,
    LBL_Date,
    LBL_Default_Page_Size,
    LBL_Default_Value,
    LBL_Delete,
    LBL_Description,
    LBL_Detail_Object,
    LBL_Display_In_Totals,
    LBL_Dotted,
    LBL_Double,
    LBL_Edit,
    LBL_End,
    LBL_Export,
    LBL_Expression,
    LBL_False,
    LBL_Field_Name,
    LBL_Field_Type,
    LBL_Filter,
    LBL_First,
    LBL_Formating_Rule,
    LBL_Grid_Layout,
    LBL_Grid_Settings,
    LBL_Groove,
    LBL_Icon_Settings,
    LBL_Icon,
    LBL_Input,
    LBL_Inset,
    LBL_Is_Field_Hidden,
    LBL_Last,
    LBL_Lower_Bound,
    LBL_Master_Object,
    LBL_Maximum,
    LBL_Minimum,
    LBL_New_Template_Name,
    LBL_New_Template,
    LBL_New,
    LBL_Next,
    LBL_No_Item_To_Display,
    LBL_No,
    LBL_None,
    LBL_Number_Of_Fixed_Columns,
    LBL_Of,
    LBL_Operation,
    LBL_Opposite_Style,
    LBL_Option,
    LBL_Output,
    LBL_Outset,
    LBL_Patern,
    LBL_Picklist_Formatting,
    LBL_Preview,
    LBL_Previous,
    LBL_Read_Only,
    LBL_Ridge,
    LBL_Save_As,
    LBL_Save,
    LBL_Select_Columns,
    LBL_Select_Master_Object,
    LBL_Select_Object,
    LBL_Select_Operation,
    LBL_Select_Total_Type,
    LBL_Selected_Fields,
    LBL_Selected,
    LBL_Settings,
    LBL_Show_Hide_Columns,
    LBL_Size,
    LBL_Solid,
    LBL_Start,
    LBL_Style,
    LBL_Template_List,
    LBL_Template_Name,
    LBL_Template_Type,
    LBL_Text,
    LBL_Total_Type,
    LBL_True,
    LBL_Type,
    LBL_Upload_File,
    LBL_Upper_Bound,
    LBL_User_Filters,
    LBL_Value,
    LBL_Width,
    LBL_Yes,
    MSG_Add_Related_Fields,
    MSG_Application_Error,
    MSG_Between_Value_Error,
    MSG_Confirm_Delete,
    MSG_Delete_Complete,
    MSG_Deploy_Ended_With_Status,
    MSG_Deploy_Last_Status,
    MSG_Error,
    MSG_Field_Already_Exist,
    MSG_Field_Count_Exceded,
    MSG_Field_Length_Limit,
    MSG_Fill_Required_Fields,
    MSG_Filter_On_Id_Help_Text,
    MSG_Format_Rule_Added,
    MSG_Format_Rule_Removed,
    MSG_Information,
    MSG_Invalid_Expression,
    MSG_MISSING_FIELD,
    MSG_No_Items_Selected,
    MSG_Save_As_Complete,
    MSG_Save_Complete,
    MSG_Success,
    MSG_Template_Name_Used_Overwrite,
    MSG_Template_No_Detail_Object,
    MSG_Template_No_Master_Detail_Object,
    MSG_Template_No_Name,
    MSG_Template_Type_Missing,
    MSG_Warning,
};
const Operations = {
    SUM: 'SUM',
    AVG: 'AVG',
    COUNT: 'COUNT',
    ISNULL: 'ISNULL',
    ISBLANK: 'ISBLANK',
    EQUALS: 'EQUALS',
    NOT_EQUALS: 'NOT_EQUALS',
    BETWEEN: 'BETWEEN',
    GREATER: 'GREATER',
    GREATER_OR_EQUALS: 'GREATER_OR_EQUALS',
    LESS: 'LESS',
    LESS_OR_EQUALS: 'LESS_OR_EQUALS',
    CONTAINS: 'CONTAINS',
    NOT_CONTAINS: 'NOT_CONTAINS',
};
const toastError = (context, msg, stack) => {
    msg = msg && msg.hasOwnProperty('body') && msg.body.hasOwnProperty('message') ? msg.body.message : msg;
    if (msg) {
        console.error(msg);
    }
    if (stack) {
        console.error(stack);
    }
    const evt = new ShowToastEvent({
        title: MSG_Error,
        message: msg,
        variant: "error",
        mode: "dismissable"
    });
    context.dispatchEvent(evt);
};
const toastSuccess = (context, title, msg) => {
    const evt = new ShowToastEvent({
        title: title,
        message: msg,
        variant: "success",
        mode: "dismissable"
    });
    context.dispatchEvent(evt);
}
const toastInfo = (context, msg) => {
    const evt = new ShowToastEvent({
        title: MSG_Information,
        message: msg,
        variant: "info",
        mode: "dismissable"
    });
    context.dispatchEvent(evt);
}
const toastWarning = (context, msg) => {
    const evt = new ShowToastEvent({
        title: MSG_Warning,
        message: msg,
        variant: "warning",
        mode: "dismissable"
    });
    context.dispatchEvent(evt);
}
const array_move_one_item = (arr, old_index, new_index) => {
    if (new_index < 0) {
        new_index = 0;
    }
    if (new_index > arr.length) {
        new_index = arr.length;
    }
    arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);
    return arr;
}
const addToArrayIfDoesntExist = (key, newitem, arr) => {
    let alreadyExist = arr.some(item => item[key] == newitem[key]);
    if (alreadyExist) {
        return false;
    } else {
        arr.push(newitem);
        return true;
    }
}
const incrementFormat = (scale) => {
    return '' + (1 / Math.pow(10, scale));
    /* let str = '0.';
    if (scale == 0 || scale) {
        for (let index = 0; index < scale - 1; index++) {
            str += '0';
        }
    }
    return str == '0.' ? '1' : str + '1'; */
}
const trimDeveloperName = (value) => {
    return value ? value.trim().replace(/\s+/g, ' ').replace(/[ ]+/g, ' ').replace(/[^a-zA-Z0-9\_( )]/g, '').replace(/_+/g, '_') : '';
}
const trimRegex = (value) => {
    return value ? value.trim().replace(/[^a-zA-Z0-9\_\s\*( )]/g, '') : '';
}
const encodeXml = (value) => {
    if (document && document.createElement) {
        let holder = document.createElement('div');
        holder.textContent = value;
        return holder.innerHTML;
    }
    return value;
}
const evaluateExpression = (value, rulesIndexes) => {
    let pstack = [];
    let stack = [];
    let estack = [];
    try {
        if (value) {
            let emptyString = new String(value);
            let matches = new String(value).match(/AND|OR|\)|\(|[0-9]+/gi);
            if (matches) {
                for (let item of matches) {
                    if (item == '(') {
                        pstack.push(item);
                    }
                    if (item == ')') {
                        if (!pstack.length || pstack[pstack.length - 1] != '(') {
                            console.log('here >>> 1');
                            return { isSuccess: false, error: 'Syntax error' };
                        }
                        pstack.splice(pstack.length - 1, 1);
                    }
                    if (!isNaN(item)) {
                        estack.push(true);
                        if (rulesIndexes && !rulesIndexes.includes(parseInt(item))) {
                            console.log('here >>> 2');
                            return { isSuccess: false, error: 'Rule not defined', expression: item };
                        }
                    } else if (item.match(/AND|OR/gi)) {
                        estack.push('&&');
                    } else {
                        estack.push(item);
                    }
                    stack.push(item);
                    if (item) {
                        if (item == '(') {
                            item = '\\(';
                        }
                        if (item == ')') {
                            item = '\\)';
                        }
                        emptyString = emptyString.replace(new RegExp(item, 'gi'), '');
                    }
                }
            }
            emptyString = emptyString.trim();
            if (emptyString) {
                console.log('here >>> 3');
                return { isSuccess: false, error: 'Uknown expression', expression: emptyString.split(' ')[0] };
            }
            if (pstack.length) {
                console.log('here >>> 4');
                return { isSuccess: false, error: 'Syntax error', expression: stack.join(' ') };
            }
            try {
                if (estack && estack.length) {
                    eval(estack.join(' '));
                }
            } catch (error) {
                console.log('here >>> 5');
                return { isSuccess: false, error: 'Stack error', expression: stack.join(' ') };
            }
        }
    } catch (evalerror) {
        console.log(evalerror);
        console.log('here >>> 6');
        return { isSuccess: false, error: 'Stack error', expression: stack.join(' ') };
    }
    return { isSuccess: true, expression: stack.join(' ') };
}
const processControllerFields = (template, record, field, processMessages, changedFieldName) => {
    let isDisabled = false;
    if (field.controllerFieldActions && field.controllerFieldActions.length) {
        for (let controllerFieldAction of field.controllerFieldActions) {
            if (!processMessages && controllerFieldAction.action.toUpperCase().includes('_MESSAGE')) continue;
            if (changedFieldName && controllerFieldAction.action.toUpperCase().includes('_MESSAGE') && !Object.values(controllerFieldAction.criteria.rulesMap).some(rule => rule.fieldName == changedFieldName)) continue;
            let message = controllerFieldAction.message;
            let expression = controllerFieldAction.criteria.expression;
            expression = expression.replace(/AND/gi, '&&');
            expression = expression.replace(/OR/gi, '||');
            let rulesMap = controllerFieldAction.criteria.rulesMap;
            for (let ruleIndex of Object.keys(controllerFieldAction.criteria.rulesMap).sort((i1, i2) => i1 - i2)) {
                if (!expression.includes(ruleIndex)) continue;
                let fieldName = rulesMap[ruleIndex].fieldName;
                let fieldValue = fieldName.toLowerCase() != 'recordtypeid' ? record[fieldName] : record.RecordType.DeveloperName;
                let operation = rulesMap[ruleIndex].operation;
                let value = rulesMap[ruleIndex].value || '';
                let fieldType = rulesMap[ruleIndex].fieldType;
                if (value.trim() == '{!this}') {
                    value = record[field.fieldName];
                }
                if (fieldType == 'BOOLEAN') {
                    value = value == 'true' || value == true;
                    fieldValue = fieldValue == 'true' || fieldValue == true;
                } else if (fieldType == 'CURRENCY' || fieldType == 'PERCENT' || fieldType == 'LONG' || fieldType == 'INTEGER' || fieldType == 'DOUBLE') {
                    value = +value || 0;
                    fieldValue = +fieldValue || 0;
                } else if (fieldType == 'DATETIME' || fieldType == 'DATE' || fieldType == 'TIME') {
                    value = new Date(value);
                    fieldValue = new Date(fieldValue);
                }
                let res = false;
                if (Operations.GREATER == operation) {
                    res = fieldValue > value;
                }
                if (Operations.GREATER_OR_EQUALS == operation) {
                    res = fieldValue >= value;
                }
                if (Operations.LESS == operation) {
                    res = fieldValue < value;
                }
                if (Operations.LESS_OR_EQUALS == operation) {
                    res = fieldValue <= value;
                }
                if (Operations.ISNULL == operation) {
                    res = !fieldValue;
                }
                if (Operations.ISBLANK == operation) {
                    res = !fieldValue;
                }
                if (Operations.EQUALS == operation) {
                    res = fieldValue == value;
                }
                if (Operations.NOT_EQUALS == operation) {
                    res = fieldValue != value;
                }
                if (Operations.CONTAINS == operation) {
                    res = fieldValue.includes(value);
                }
                if (Operations.NOT_CONTAINS == operation) {
                    res = !fieldValue.includes(value);
                }
                expression = expression.replace(new RegExp(ruleIndex, 'gi'), res);
            }
            let expressionResult = false;
            try {
                expressionResult = eval(expression);
            } catch (error) {
            }
            if (expressionResult) {
                if (controllerFieldAction.action.toUpperCase() == 'DISABLE') {
                    isDisabled |= expressionResult;
                }
                if (controllerFieldAction.action.toUpperCase() == 'ERROR_MESSAGE') {
                    toastError(template, message, null);
                }
                if (controllerFieldAction.action.toUpperCase() == 'WARNING_MESSAGE') {
                    toastWarning(template, message);
                }
                if (controllerFieldAction.action.toUpperCase() == 'INFO_MESSAGE') {
                    toastInfo(template, message);
                }
                if (controllerFieldAction.action.toUpperCase() == 'SUCCESS_MESSAGE') {
                    toastSuccess(template, null, message);
                }
            }
        }
    }
    return isDisabled;
}
const getFieldOperationByType = (field) => {
    if (field.isReference) {
        return [
            { label: 'ISNULL', value: Operations.ISNULL },
            { label: 'ISBLANK', value: Operations.ISBLANK },
            { label: 'EQUALS', value: Operations.EQUALS },
            { label: 'NOT EQUALS', value: Operations.NOT_EQUALS },
        ];
    }
    if (field.isText) {
        return [
            { label: 'ISNULL', value: Operations.ISNULL },
            { label: 'ISBLANK', value: Operations.ISBLANK },
            { label: 'EQUALS', value: Operations.EQUALS },
            { label: 'NOT EQUALS', value: Operations.NOT_EQUALS },
            { label: 'CONTAINS', value: Operations.CONTAINS },
            { label: 'DOESNT CONTAINS', value: Operations.NOT_CONTAINS },
        ];
    }
    if (field.isRecordTypeId) {
        return [
            { label: 'ISNULL', value: Operations.ISNULL },
            { label: 'ISBLANK', value: Operations.ISBLANK },
            { label: 'EQUALS', value: Operations.EQUALS },
            { label: 'NOT EQUALS', value: Operations.NOT_EQUALS },
        ];
    }
    if (field.isBoolean) {
        return [
            { label: 'EQUALS', value: Operations.EQUALS },
            { label: 'NOT EQUALS', value: Operations.NOT_EQUALS },
        ];
    }
    if (field.isDate || field.isDateTime || field.isTime || field.isNumber) {
        return [
            { label: 'EQUALS', value: Operations.EQUALS },
            { label: 'NOT EQUALS', value: Operations.NOT_EQUALS },
            { label: 'GREATER', value: Operations.GREATER },
            { label: 'GREATER OR EQUALS', value: Operations.GREATER_OR_EQUALS },
            { label: 'LESS', value: Operations.LESS },
            { label: 'LESS OR EQUALS', value: Operations.LESS_OR_EQUALS },
            // { label: 'BETWEEN', value: Operations.BETWEEN },
        ];
    }
    return [{ label: Labels.LBL_None, value: '' }];
}
export { Labels, Operations, toastWarning, toastInfo, toastError, toastSuccess, array_move_one_item, addToArrayIfDoesntExist, incrementFormat, trimDeveloperName, trimRegex, encodeXml, evaluateExpression, getFieldOperationByType, processControllerFields };